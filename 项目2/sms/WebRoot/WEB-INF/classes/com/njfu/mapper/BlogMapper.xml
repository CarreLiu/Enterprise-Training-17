<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.njfu.dao.BlogDao">

	<resultMap type="blog" id="blogResultMap">
      <id property="bid" column="bid"/>
      <result property="title" column="title"/>
      <result property="content" column="content"/>
      <result property="createDate" column="createDate"/>
      <result property="sid" column="sid"/>
      
      <association property="student" javaType="student">
         <id property="sid" column="sid"/>
         <result property="username" column="username"/>
         <result property="password" column="password"/>
         <result property="name" column="name"/>
      </association>
	</resultMap>
	
	<select id="selectAll" resultMap="blogResultMap">
		select 
			b.bid "bid",
			b.title "title",
			b.content "content",
			b.createDate "createDate",
			s.sid "sid",
			s.username "username",
			s.password "password",
			s.name "name"
		from
			blog b
			left join
				student s 
			on
				b.sid=s.sid
	</select>
	
	<select id="selectById" resultMap="blogResultMap">
		select 
			b.bid "bid",
			b.title "title",
			b.content "content",
			b.createDate "createDate",
			s.sid "sid",
			s.username "username",
			s.password "password",
			s.name "name"
		from
			blog b
			left join
				student s 
			on
				b.sid=s.sid
		where
			b.bid=#{bid}
	</select>
	
	<delete id="deleteBlog">
     	delete
     	from
     		blog
     	where
     		bid=#{bid}
     </delete>
     
     <select id="selectBlogByStudent" resultMap="blogResultMap">
		select 
			b.bid "bid",
			b.title "title",
			b.content "content",
			b.createDate "createDate",
			s.sid "sid",
			s.username "username",
			s.password "password",
			s.name "name"
		from
			blog b
			left join
				student s 
			on
				b.sid=s.sid
		where
			b.sid=#{sid}
	</select>
	
	<insert id="insertBlog" parameterType="blog">
		insert into
			blog
				(title,content,createDate,sid)
		values
			(#{title},#{content},#{createDate},#{sid})
	
	</insert>
	
	<update id="updateBlog" parameterType="blog">
		update
			blog
		set
			title=#{title}, content=#{content}
		where
			bid=#{bid}
	</update>
</mapper>